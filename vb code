Function darksider_con(rng As Range) As String
  Dim cell As Range
  Dim result As String
  For Each cell In rng
    result = result & cell.Value & ","
  Next
  darksider_con = result
End Function


Function mm(v As String)
  Select Case v
   Case "A", "AM", "a", "am"
    mm = 1
   Case "P", "PM"
    mm = 2
   Case "AP"
    mm = 3
   Case "CS"
    mm = 4
   
   Case "0"
    mm = "0"
   Case "AL"
    mm = 41
   Case "CL"
    mm = 42
   Case "LSL", "LPPA"
    mm = 43
   Case "PAT"
    mm = 44
   Case "MAT"
    mm = 45
   Case "U"
    mm = 99
   Case "UA"
    mm = 91
   Case "UP"
    mm = 92
   Case "77"
    mm = 77
   Case "d1", "d2", "d3", "d4", "d5", "d6", "d7", "d8"
    mm = v
   Case "OTH"
    mm = 0
    
   Case Else
    mm = "FAIL-->" & v
  End Select
  
End Function


Function count_leave(v As String)
  Select Case v
      Case "AL", "CL", "LSL", "PAT", "MAT", "LPPA"
        count_leave = 1
      Case Else
        count_leave = 0
  End Select

End Function



Function really_darker_sider(rng As Range) As String
  Dim cell As Range
  Dim result As String
  Dim leave_count_constraint As String
  Dim leave_counter As Integer
  
  
  Dim doc As String
  Dim ctr As Integer
  
  ctr = 0
  
  leave_count_constraint = ""
  leave_counter = 0
  For Each cell In rng
    
    Let ctr = ctr + 1
    
    If ctr Mod 70 = 1 Then doc = cell.Offset(0, -1).Value
            
    If ctr Mod 7 = 0 Then
      
      result = result & mm(cell.Value) & "," & vbTab & "% day " & ctr Mod 70 & " " & doc & vbCrLf
    Else
      result = result & mm(cell.Value) & "," & vbTab
    End If
    
    leave_counter = leave_counter + count_leave(cell.Value)
    
    
    If ctr Mod 70 = 0 Then result = result & "                            %leave count " & doc & " is " & leave_counter & vbCrLf & vbCrLf
    
    
    If ctr Mod 70 = 0 Then leave_count_constraint = leave_count_constraint & "constraint count(roster[" & doc & ",..],l) = " & leave_counter & ";" & vbCrLf
    
    If ctr Mod 70 = 0 Then leave_counter = 0
    
    
    
  Next cell
  really_darker_sider = result
  Debug.Print "array[ docs,1..DAYS] of var int:  REQUESTS = array2d(docs,1..DAYS,[" & vbCrLf
  Debug.Print result & vbCrLf
  Debug.Print "]); %end of REQUESTS ARRAY" & vbCrLf


  Debug.Print leave_count_constraint
  
  

End Function



Function make_separate_arrays(rng As Range) As String
Dim cell As Range
  Dim result As String
  Dim requests As String
  
  Dim leave_count_constraint As String
  Dim leave_counter As Integer
  
  
  Dim doc As String
  Dim ctr As Integer
  
  ctr = 0
  
  leave_count_constraint = ""
  leave_counter = 0
  'array[docs,1..70] of var int: R2;
  'constraint R2[RG,1..70]=RG_requests;
  'constraint R2[GM,1..70]=GM_requests;

  
  requests = requests & "array[docs,1..70] of var int: REQUESTS;" & vbCrLf
  
  For Each cell In rng
    
    Let ctr = ctr + 1
    
    If ctr Mod 70 = 1 Then
     doc = cell.Offset(0, -1).Value
     result = result & "array[1..70] of var int: " & doc & "_requests = array1d(1..70,[" & vbCrLf
    
     requests = requests & "constraint REQUESTS[" & doc & ",1..70] = " & doc & "_requests;" & vbCrLf
    
    End If
    
    If ctr Mod 7 = 0 Then
      
      result = result & mm(cell.Value) & "," & vbTab & "% day " & ctr Mod 70 & " " & doc & vbCrLf
    Else
      result = result & mm(cell.Value) & "," & vbTab
    End If
    
    leave_counter = leave_counter + count_leave(cell.Value)
    
    
    If ctr Mod 70 = 0 Then result = result & "                            %leave count " & doc & " is " & leave_counter & vbCrLf & vbCrLf
    If ctr Mod 70 = 0 Then result = result & " ]); % end of array for doc " & doc & vbCrLf & vbCrLf
               
    If ctr Mod 70 = 0 Then leave_count_constraint = leave_count_constraint & "constraint count(roster[" & doc & ",..],l) = " & leave_counter & ";" & vbCrLf
    
    If ctr Mod 70 = 0 Then leave_counter = 0
    
    
    
  Next cell
  
  'Dim Path As String
  'Dim FileNumber As Integer

   Path = "C:\Users\MeleG\Desktop\MHSMS\this_month.txt"
   
  FileNumber = FreeFile
  Open Path For Output As FileNumber

    Print #FileNumber, result
    Print #FileNumber, leave_count_constraint & vbcrllf & vbCrLf
    Print #FileNumber, requests
    Print #FileNumber, "%%% put the dates function next"
    
    Close FileNumber
      
  
  make_separate_arrays = result
  Debug.Print result

  Debug.Print leave_count_constraint & vbCrLf & vbCrLf
  
  Debug.Print requests
  
  Debug.Print "%%% put the dates function next"
  
  




End Function


Function make_dates(rng As Range)
     Dim result As String
     Dim ctr As Integer
     Dim date_str As String
     
     result = ""
     ctr = 0
     
     For Each cell In rng
       cell.NumberFormat = "dd/mm/yyyy"
       
       ctr = ctr + 1
       If ctr = 1 Then
          result = result & "if     d = 1 then " & Chr(34) & Format(cell.Value, "dd/mm/yyyy") & Chr(34) & vbCrLf
        Else
       result = result & "elseif d = " & ctr & " then " & Chr(34) & Format(cell.Value, "dd/mm/yyyy") & Chr(34) & vbCrLf
        End If
     Next
     result = "function string: get_day(days: d) = " & vbCrLf & result
               
     result = result & "else " & vbTab & Chr(34) & "nuffin" & Chr(34) & vbCrLf
     
     result = result & "endif; % end of the big if"
          
    Debug.Print result
End Function

